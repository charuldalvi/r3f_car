/*
Auto-generated by: https://github.com/pmndrs/gltfjsx
*/

import React, { useRef, useState } from "react";
import * as THREE from "three";
import { FlakesTexture } from "three/examples/jsm/textures/FlakesTexture.js";
import { Html, useGLTF, useTexture } from "@react-three/drei";
import { useStore } from "./stateManagement";
import {
  Bloom,
  EffectComposer,
  SelectiveBloom,
  Vignette,
  Noise,
} from "@react-three/postprocessing";
import { BlurPass, Resizer, KernelSize } from "postprocessing";

import controlsBaseColor from "./assets/interior_textures/Controls_baseColor.jpeg";

// Let's make the marker into a component so that we can abstract some shared logic
function Marker({ children, ...props }) {
  // This holds the visible state
  const [hidden, set] = useState();
  return (
    <Html
      distanceFactor={8}
      occlude
      // The <Html> component can tell us when something is occluded (or not)
      onOcclude={set}
      style={{
        transition: "all 0.2s",
        opacity: hidden ? 0 : 1,
        transform: `scale(${hidden ? 0.25 : 1})`,
      }}
      {...props}
    >
      {children}
    </Html>
  );
}

export default function Model({ metalness, roughness, props }) {
  const group = useRef();
  const steeringRef = useRef();
  const directionalRef = useRef();
  const leftLightRef = useRef();
  const leftfrontglass = useRef();

  const { nodes, materials } = useGLTF("/src/bmw.glb");

  const interiorClicked = true;
  const primaryColor = useStore((state) => state.primaryColor);
  const secondaryColor = useStore((state) => state.secondaryColor);
  const interiorPrimaryColor = useStore((state) => state.interiorUpholestry);
  const interiorSecondaryColor = useStore(
    (state) => state.interiorSecondaryColor
  );
  const controlsColor = useStore((state) => state.controlsColor);
  const topControls = useStore((state) => state.topControls);
  const headSeat = useStore((state) => state.headSeat);
  const leatherSewing = useStore((state) => state.leatherSewing);
  const backSeat = useStore((state) => state.backSeat);
  const isInteriorChanged = useStore((state) => state.isInteriorChanged);
  const mapFlip = useStore((state) => state.setIsMapFliped);
  const isInteriorClicked = useStore((state) => state.isInteriorClicked);
  const rotateNow = useStore((state) => state.rotateNow);
  const setSteeringPosition = useStore((state) => state.setSteeringPosition);
  const setIsInteriorClicked = useStore((state) => state.setIsInteriorClicked);

  const [isHovered, setHoveredState] = useState(false);

  const canals = useRef();

  const controls = useTexture(controlsColor);
  const topControl = useTexture(topControls);
  const controlsBase = useTexture(controlsBaseColor);
  const upholestry = useTexture(interiorPrimaryColor);
  const headSeatFabric = useTexture(headSeat);
  const frontLeather = useTexture(leatherSewing);
  const backLeather = useTexture(backSeat);

  if (headSeatFabric) {
    headSeatFabric.wrapS = headSeatFabric.wrapT = THREE.RepeatWrapping;
    headSeatFabric.repeat.set(1.8, 1.8);
  }

  const normalMap3 = new THREE.CanvasTexture(new FlakesTexture());
  normalMap3.wrapS = THREE.RepeatWrapping;
  normalMap3.wrapT = THREE.RepeatWrapping;
  normalMap3.repeat.x = 10;
  normalMap3.repeat.y = 6;

  return (
    <group ref={group} {...props} dispose={null} position={[0.2, 1.48, 0]}>
      <group scale={0.04}>
        <group rotation={[-Math.PI / 2, 0, Math.PI]}>
          <mesh
            materialWireframe={true}
            castShadow
            receiveShadow
            geometry={nodes.mesh_0.geometry}
            material={nodes.mesh_0.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_5.geometry}
            material={nodes.mesh_5.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_13.geometry}
            material={nodes.mesh_13.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_19.geometry}
            material={nodes.mesh_19.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_25.geometry}
            material={nodes.mesh_25.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_85.geometry}
            material={nodes.mesh_85.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_86.geometry}
            material={nodes.mesh_86.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_87.geometry}
            material={nodes.mesh_87.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_88.geometry}
            material={nodes.mesh_88.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_89.geometry}
            material={nodes.mesh_89.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_90.geometry}
            material={nodes.mesh_90.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_91.geometry}
            material={nodes.mesh_91.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_92.geometry}
            material={nodes.mesh_92.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_98.geometry}
            material={nodes.mesh_98.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_99.geometry}
            material={nodes.mesh_99.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_100.geometry}
            material={nodes.mesh_100.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_101.geometry}
            material={nodes.mesh_101.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_102.geometry}
            material={nodes.mesh_102.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_103.geometry}
            material={nodes.mesh_103.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_104.geometry}
            material={nodes.mesh_104.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_105.geometry}
            material={nodes.mesh_105.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_119.geometry}
            material={materials.Full_White}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_122.geometry}
            material={nodes.mesh_122.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_144.geometry}
            material={materials.Inside_Front_Light_Metal}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_151.geometry}
            material={materials.Logo_Aluminium}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_158.geometry}
            material={nodes.mesh_158.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_159.geometry}
            material={nodes.mesh_159.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_160.geometry}
            material={nodes.mesh_160.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_161.geometry}
            material={nodes.mesh_161.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_168.geometry}
            material={materials.Logo_White}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_169.geometry}
            material={nodes.mesh_169.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_176.geometry}
            material={nodes.mesh_176.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_180.geometry}
            material={nodes.mesh_180.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_181.geometry}
            material={nodes.mesh_181.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_188.geometry}
            material={materials.Seats_Leather}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_3.geometry}
            material={nodes.mesh_3.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_4.geometry}
            material={nodes.mesh_4.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_6.geometry}
            material={materials.Carbon_Fiber}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_9.geometry}
            material={materials.E_Logo_Metal}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_10.geometry}
            material={materials.Grey_Normal}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_11.geometry}
            material={materials.Leather_Beige}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_12.geometry}
            material={materials.Light_Rear}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_14.geometry}
            material={materials.Middle_Back_Led}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_16.geometry}
            material={materials.PRotonicFinal}
          >
            <meshPhysicalMaterial
              color={`#${secondaryColor}`}
              metalness={0.2}
              roughness={roughness}
              clearcoatRoughness={0.1}
              reflectivity={0.1}
            />
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_17.geometry}
            material={materials.Panel_Led}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_18.geometry}
            material={materials.Plastic_Blue}
          ></mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_20.geometry}
            material={nodes.mesh_20.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_21.geometry}
            material={materials.Plastico_Azul}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_22.geometry}
            material={materials.Protonic}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_23.geometry}
            material={materials.RoofLight}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_24.geometry}
            material={materials.Roof_Light_Glass}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_29.geometry}
            material={materials.Wheel_Tubes}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_30.geometry}
            material={materials.wire_028028177}
          >
            <meshPhysicalMaterial
              color={`#${secondaryColor}`}
              metalness={metalness}
              roughness={roughness}
              clearcoatRoughness={0.1}
              clearcoat={1}
              envMapIntensity={1.2}
            />
            {/* <Marker rotation={[0, Math.PI / 2, 0]} position={[-20, -35, 10]}>
              <div
                onMouseOver={() => {
                  setHoveredState(true);
                }}
                onMouseOut={() => {
                  setHoveredState(false);
                }}
                onClick={() => {
                  setIsInteriorClicked(interiorClicked);
                  console.log(isInteriorClicked);
                }}
                style={{
                  width: "5px",
                  height: "5px",
                  background: isHovered === true ? "white" : " ",
                  outline: "0.5px solid #fff",
                  outlineOffset: "2px",
                  transform: "rotate(45deg)",
                  cursor: "pointer",
                }}
              ></div>
            </Marker> */}
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_31.geometry}
            material={materials.wire_143225087}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_33.geometry}
            material={nodes.mesh_33.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_34.geometry}
            material={nodes.mesh_34.material}
          >
            <meshPhysicalMaterial
              color={`#${primaryColor}`}
              metalness={metalness}
              roughness={roughness}
              clearcoatRoughness={0.1}
              reflectivity={0.2}
              clearcoat={1}
              envMapIntensity={1.5}
              // normalMap={normalMap3}
              // normalScale={[0.15, 0.15]}
            />
            {/* <Marker rotation={[0, Math.PI / 2, 0]} position={[30, -50, 10]}>
              <div
                onMouseOver={() => {
                  setHoveredState(true);
                }}
                onMouseOut={() => {
                  setHoveredState(false);
                }}
                onClick={() => {setIsInteriorClicked()}}
                style={{
                  width: "15px",
                  height: "15px",
                  background: isHovered === true ? "white" : " ",
                  outline: "1px solid #fff",
                  outlineOffset: "2px",
                  transform: "rotate(45deg)",
                  cursor: 'pointer'
                }}
              ></div>
            </Marker> */}
          </mesh>

          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_35.geometry}
            material={materials["02_CAR_BLACK_COLOR"]}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_36.geometry}
            material={nodes.mesh_36.material}
            // material-color={`#${primaryColor}`}
            // material-emissive={`#${primaryColor}`}
            // material-emissiveIntensity={1}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_37.geometry}
            material={nodes.mesh_37.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_38.geometry}
            material={materials.AllLigths_Inside_Red}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_39.geometry}
            material={nodes.mesh_39.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_40.geometry}
            material={nodes.mesh_40.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_41.geometry}
            material={nodes.mesh_41.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_42.geometry}
            material={nodes.mesh_42.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_43.geometry}
            material={nodes.mesh_43.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_44.geometry}
            material={nodes.mesh_44.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_45.geometry}
            material={nodes.mesh_45.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_46.geometry}
            material={nodes.mesh_46.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_47.geometry}
            material={nodes.mesh_47.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_48.geometry}
            material={nodes.mesh_48.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_49.geometry}
            material={nodes.mesh_49.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_50.geometry}
            material={nodes.mesh_50.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_51.geometry}
            material={nodes.mesh_51.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_52.geometry}
            material={nodes.mesh_52.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_53.geometry}
            material={nodes.mesh_53.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_54.geometry}
            material={nodes.mesh_54.material}
          >
            <meshPhysicalMaterial
              transmission={2.5}
              color={0xffff0000}
              clearcoatRoughness={3}
              ior={1}
              roughness={0.02}
              thickness={0.4}
              envMapIntensity={0.2}
            />
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_55.geometry}
            material={nodes.mesh_55.material}
          >
            <meshPhysicalMaterial
              transmission={2.5}
              color={0xffff0000}
              clearcoatRoughness={3}
              ior={1}
              roughness={0.02}
              thickness={0.4}
              envMapIntensity={0.2}
            />
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_56.geometry}
            material={nodes.mesh_56.material}
          ></mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_57.geometry}
            material={nodes.mesh_57.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_58.geometry}
            material={materials.BackLight_Rear}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_59.geometry}
            material={nodes.mesh_59.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_60.geometry}
            material={nodes.mesh_60.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_61.geometry}
            material={materials.Back_Red_Light_BackGround}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_63.geometry}
            material={nodes.mesh_63.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_64.geometry}
            material={nodes.mesh_64.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_65.geometry}
            material={nodes.mesh_65.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_66.geometry}
            material={nodes.mesh_66.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_67.geometry}
            material={nodes.mesh_67.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_68.geometry}
            material={nodes.mesh_68.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_69.geometry}
            material={nodes.mesh_69.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_70.geometry}
            material={nodes.mesh_70.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_71.geometry}
            material={nodes.mesh_71.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_72.geometry}
            material={nodes.mesh_72.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_73.geometry}
            material={nodes.mesh_73.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_74.geometry}
            material={nodes.mesh_74.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_75.geometry}
            material={nodes.mesh_75.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_76.geometry}
            material={nodes.mesh_76.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_77.geometry}
            material={nodes.mesh_77.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_78.geometry}
            material={nodes.mesh_78.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_79.geometry}
            material={nodes.mesh_79.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_80.geometry}
            material={nodes.mesh_80.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_81.geometry}
            material={nodes.mesh_81.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_82.geometry}
            material={nodes.mesh_82.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_83.geometry}
            material={nodes.mesh_83.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_84.geometry}
            material={nodes.mesh_84.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_93.geometry}
            material={nodes.mesh_93.material}
          >
            <meshPhysicalMaterial
              color={`#${secondaryColor}`}
              metalness={metalness}
              roughness={roughness}
              clearcoatRoughness={0.1}
              reflectivity={0.1}
            />
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_109.geometry}
            material={materials.Carpet_Outline}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_113.geometry}
            material={nodes.mesh_113.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_114.geometry}
            material={nodes.mesh_114.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_115.geometry}
            material={nodes.mesh_115.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_116.geometry}
            material={nodes.mesh_116.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_117.geometry}
            material={materials.E_Logo}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_118.geometry}
            material={materials.Full_Black}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_120.geometry}
            material={nodes.mesh_120.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_121.geometry}
            material={nodes.mesh_121.material}
          />
          <group>
            <mesh
              ref={leftfrontglass}
              castShadow
              receiveShadow
              geometry={nodes.mesh_123.geometry}
              material={nodes.mesh_123.material}
            >
              <meshPhysicalMaterial
                transmission={0.3}
                thickness={1}
                color={0xffffff}
                clearcoatRoughness={1}
                ior={1}
                roughness={0.02}
                envMapIntensity={0.2}
              />
            </mesh>
          </group>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_124.geometry}
            material={nodes.mesh_124.material}
          >
            <meshPhysicalMaterial
              transmission={0.3}
              thickness={1}
              color={0xffffff}
              clearcoatRoughness={1}
              ior={1}
              roughness={0.02}
              envMapIntensity={0.2}
            />
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_125.geometry}
            material={materials.Glass_Lines_Back}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_126.geometry}
            material={nodes.mesh_126.material}
          >
            <meshPhysicalMaterial
              transmission={1}
              thickness={3}
              color={0xffffff}
              clearcoatRoughness={1}
              ior={1}
              roughness={0.02}
              envMapIntensity={0.2}
            />
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_127.geometry}
            material={nodes.mesh_127.material}
          >
            <meshPhysicalMaterial
              transmission={1}
              thickness={3}
              color={0xffffff}
              clearcoatRoughness={1}
              ior={1}
              roughness={0.02}
              envMapIntensity={0.2}
            />
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_128.geometry}
            material={nodes.mesh_128.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_129.geometry}
            material={nodes.mesh_129.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_130.geometry}
            material={nodes.mesh_130.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_131.geometry}
            material={nodes.mesh_131.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_132.geometry}
            material={nodes.mesh_132.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_133.geometry}
            material={nodes.mesh_133.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_134.geometry}
            material={nodes.mesh_134.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_135.geometry}
            material={nodes.mesh_135.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_136.geometry}
            material={nodes.mesh_136.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_137.geometry}
            material={nodes.mesh_137.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_138.geometry}
            material={nodes.mesh_138.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_139.geometry}
            material={materials.HeadLight_Metal}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_143.geometry}
            material={materials.Inside_BackLights}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_145.geometry}
            material={materials.Inside_Led_TailLight}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_146.geometry}
            material={materials.Laser_Inside_Bend_Plastic}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_147.geometry}
            material={nodes.mesh_147.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_148.geometry}
            material={nodes.mesh_148.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_152.geometry}
            material={nodes.mesh_152.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_153.geometry}
            material={nodes.mesh_153.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_154.geometry}
            material={nodes.mesh_154.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_155.geometry}
            material={nodes.mesh_155.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_156.geometry}
            material={nodes.mesh_156.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_157.geometry}
            material={nodes.mesh_157.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_162.geometry}
            material={materials.Logo_Metal_01}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_163.geometry}
            material={nodes.mesh_163.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_164.geometry}
            material={nodes.mesh_164.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_165.geometry}
            material={nodes.mesh_165.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_166.geometry}
            material={nodes.mesh_166.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_167.geometry}
            material={nodes.mesh_167.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_170.geometry}
            material={nodes.mesh_170.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_171.geometry}
            material={nodes.mesh_171.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_172.geometry}
            material={nodes.mesh_172.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_173.geometry}
            material={nodes.mesh_173.material}
          />
          <group>
            <mesh
              ref={leftLightRef}
              castShadow
              receiveShadow
              geometry={nodes.mesh_174.geometry}
              material={materials.Plastic_Glass}
            >
              <meshPhysicalMaterial
                emissive={0xffffff}
                emissiveIntensity={100}
                specular={0xffffff}
                shininess={1000}
              />
            </mesh>
          </group>

          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_175.geometry}
            material={materials.Plastic_Glass_Lines_Bend}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_177.geometry}
            material={nodes.mesh_177.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_178.geometry}
            material={nodes.mesh_178.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_179.geometry}
            material={nodes.mesh_179.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_182.geometry}
            material={nodes.mesh_182.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_183.geometry}
            material={nodes.mesh_183.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_184.geometry}
            material={nodes.mesh_184.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_185.geometry}
            material={nodes.mesh_185.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_186.geometry}
            material={nodes.mesh_186.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_187.geometry}
            material={nodes.mesh_187.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_190.geometry}
            material={materials.Standard_16}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_193.geometry}
            material={nodes.mesh_193.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_194.geometry}
            material={nodes.mesh_194.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_195.geometry}
            material={materials.Tire_Side_Plain}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_196.geometry}
            material={materials.UpMirror}
          ></mesh>

          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_199.geometry}
            material={materials.wire_087224198}
          >
            <meshPhongMaterial emissive={0xffffff} emissiveIntensity={150} />
          </mesh>

          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_1.geometry}
            material={materials.Display_Panel}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_2.geometry}
            material={materials.BackSeats}
            material-map={backLeather}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_7.geometry}
            material={materials.Display_GPS}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_28.geometry}
            material={materials.TopControls}
            material-map={topControl}
            material-map-flipY={false}
          ></mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_62.geometry}
            material={materials.Belt}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_15.geometry}
            material={materials.Mirror_Plastic}
          ></mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_94.geometry}
            material={nodes.mesh_94.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_95.geometry}
            material={nodes.mesh_95.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_96.geometry}
            material={nodes.mesh_96.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_97.geometry}
            material={nodes.mesh_97.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_106.geometry}
            material={nodes.mesh_106.material}
          />
          <mesh
            ref={canals}
            castShadow
            receiveShadow
            geometry={nodes.mesh_107.geometry}
            material={nodes.mesh_107.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_108.geometry}
            material={materials.Carpet}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_140.geometry}
            material={nodes.mesh_140.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_141.geometry}
            material={nodes.mesh_141.material}
            material-map={headSeatFabric}
            material-map-flipY={false}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_142.geometry}
            material={nodes.mesh_142.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_8.geometry}
            material={materials.Reflect_Controls}
            material-emissiveMap={controls}
            material-emissive={0xffffff}
            material-emissiveIntensity={3}
            material-map-flipY={false}
          >
            {/* <meshPhysicalMaterial
              map={materials.Reflect_Controls.map}
              emissiveMap={materials.Reflect_Controls.emissiveMap}
              emissive={0xffffff}
              emissiveIntensity={3}
            /> */}
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_27.geometry}
            material={materials.SteeringWheel}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_149.geometry}
            material={nodes.mesh_149.material}
            material-map={frontLeather}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_150.geometry}
            material={nodes.mesh_150.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_191.geometry}
            material={nodes.mesh_191.material}
          />
          <mesh
            ref={steeringRef}
            geometry={nodes.mesh_192.geometry}
            material={nodes.mesh_192.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_26.geometry}
            material={materials.Shine_Display}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_110.geometry}
            material={nodes.mesh_110.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_111.geometry}
            material={nodes.mesh_111.material}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_112.geometry}
            material={nodes.mesh_112.material}
            material-emissiveMap={controls}
            material-emissive={0xffffff}
            material-emissiveIntensity={3}
            material-map-flipY={false}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_197.geometry}
            material={nodes.mesh_197.material}
            material-map={upholestry}
            material-needsUpdate
          >
            {/* <meshPhysicalMaterial
              map={upholestry}
              metalness={0.5}
              roughness={1}
              clearcoatRoughness={0.5}
              reflectivity={0.5}
              needsUpdate
            /> */}
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_198.geometry}
            material={nodes.mesh_198.material}
            material-map={upholestry}
            material-needsUpdate
          >
            {/* <meshPhysicalMaterial
              map={upholestry}
              metalness={0.5}
              roughness={1}
              clearcoatRoughness={0.5}
              reflectivity={0.5}
              needsUpdate
            /> */}
          </mesh>
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_189.geometry}
            material={materials.SoundDevice}
          />
          <mesh
            castShadow
            receiveShadow
            geometry={nodes.mesh_200.geometry}
            material={materials.wire_177148027}
          />
        </group>
      </group>
      {/* <directionalLight
        ref={directionalRef}
        color={0xffffff}
        intensity={1}
        position={[12, 3, 10]}
        castShadow
      /> */}
      {/* <EffectComposer>
        <SelectiveBloom
          lights={[directionalRef]} // ⚠️ REQUIRED! all relevant lights
          selection={[leftLightRef]} // selection of objects that will have bloom effect
          selectionLayer={10} // selection layer
          intensity={10.0} // The bloom intensity.
          blurPass={undefined} // A blur pass.
          width={Resizer.AUTO_SIZE} // render width
          height={Resizer.AUTO_SIZE} // render height
          kernelSize={KernelSize.LARGE} // blur kernel size
          luminanceThreshold={1.5} // luminance threshold. Raise this value to mask out darker elements in the scene.
          luminanceSmoothing={0.25} // smoothness of the luminance threshold. Range is [0, 1]
        />
        <Bloom luminanceThreshold={0.2} luminanceSmoothing={1.5} height={1000} />
        <Noise opacity={0.02} />
        <Vignette eskil={false} offset={0.5} darkness={0.5} />
      </EffectComposer> */}
    </group>
  );
}

useGLTF.preload("/src/bmw.glb");
